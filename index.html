<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=yes" />
  <title>MHACbase - Marine Hypoxic Areas Database</title>
  <link rel="stylesheet" href="https://unpkg.com/@antv/l7@latest/dist/l7.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    /* 基础重置与字体 */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html {
      font-size: 16px;
    }
    @media (max-width: 768px) {
      html {
        font-size: 14px;
      }
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      height: 100vh;
      background: linear-gradient(135deg, #0a192f 0%, #1a3a5f 100%);
      color: #fff;
      overflow: hidden;
      position: relative;
      font-size: 1rem;
      line-height: 1.5;
    }
    .header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      padding: 5.5rem 5vw;
      position: relative;
    }
    .ocean-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
    }
    .nav-menu {
      background: none;
      border-radius: 0;
      backdrop-filter: none;
      padding: 0;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      position: absolute;
      left: 5vw;
      bottom: 1.5rem;
      z-index: 3;
    }
    .nav-item {
      color: rgba(128,128,128,0.75);
      font-size: 1.1rem;
      margin: 0 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      padding: 0.5rem 1rem;
      border-radius: 30px;
      display: flex;
      align-items: center;
      white-space: nowrap;
    }
    .nav-item.active {
      background: rgba(79,195,247,0.4);
      box-shadow: 0 0 15px rgba(79,195,247,0.5);
      color: #fff;
    }
    .nav-separator {
      color: rgba(255,255,255,0.3);
      font-size: 1.5rem;
      user-select: none;
    }
    .header-icon {
      position: absolute;
      right: 3rem;
      top: 30%;
      transform: translateY(-50%);
      height: 9rem;
      width: 9rem;
      z-index: 2;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .header-icon img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    h1 {
      position: absolute;
      left: 5vw;
      top: 30%;
      transform: translateY(-50%);
      z-index: 2;
      text-shadow: 0 0.125rem 0.625rem rgba(0,0,0,0.7);
      user-select: none;
    }
    .title-bold {
      font-size: clamp(1.8rem, 4vw, 3.5rem);
    }
    .title-normal {
      font-size: clamp(1rem, 2vw, 1.4rem);
      margin-top: 0;
      line-height: 1.2;
    }

    /* 内容区 */
    .content-container {
      display: flex;
      height: 80vh;
      width: 100vw;
      overflow: hidden;
    }
    .map-container {
      width: 65%;
      height: 100%;
      position: relative;
      min-width: 300px;
    }
    #world-map {
      width: 100%;
      height: 100%;
    }
    .home-content {
      width: 35%;
      padding: 2rem 1.5rem;
      overflow-y: auto;
      background: rgba(15, 35, 65, 0.7);
      backdrop-filter: blur(5px);
      border-left: 1px solid rgba(79, 195, 247, 0.2);
      min-width: 280px;
      font-size: 1rem;

      /* 关键：使用 Grid 让两个卡片等高并充满右侧区域 */
      display: grid;
      grid-template-rows: 1fr 1fr;
      gap: 1.8rem;
    }
    .stats-card {
      background: rgba(25, 47, 79, 0.5);
      border-radius: 15px;
      padding: 1.8rem;
      box-shadow: 0 0.25rem 0.9375rem rgba(0,0,0,0.3);
      border: 1px solid rgba(79, 195, 247, 0.2);
      display: flex;
      flex-direction: column;
    }
    .stats-card h3 {
      color: #4FC3F7;
      margin-bottom: 1.2rem;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .data-highlight {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      margin-top: auto; /* 将数字卡片推到底部 */
    }
    .highlight-card {
      background: rgba(79, 195, 247, 0.15);
      border-radius: 20px;
      padding: 1.2rem;
      text-align: center;
      flex: 1;
      user-select: none;
      min-width: 120px;
    }
    .highlight-value {
      font-size: 2.2rem;
      font-weight: 700;
      color: #4FC3F7;
      margin-bottom: 0.3rem;
      line-height: 1;
    }
    .highlight-label {
      font-size: 0.95rem;
      opacity: 0.8;
    }

    /* 饼图容器：完全填充剩余空间 */
    #species-pie-chart {
      width: 100%;
      flex: 1;
      min-height: 240px; /* 最小高度防止太挤 */
      margin-top: 1rem;
    }

    #tooltip {
      position: absolute;
      padding: 1.25rem 1.5rem;
      background: rgba(25,47,79,0.97);
      border-radius: 12px;
      box-shadow: 0 0 25px rgba(0,0,0,0.8);
      pointer-events: none;
      max-width: 350px;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease;
      color: #fff;
      border: 2px solid #4FC3F7;
      backdrop-filter: blur(5px);
      font-size: 1rem;
      line-height: 1.4;
    }
    .page-content {
      padding: 2rem 1.5rem;
      display: none;
      height: 80vh;
      overflow-y: auto;
      background: rgba(15, 35, 65, 0.7);
      backdrop-filter: blur(5px);
      font-size: 1rem;
    }
    .page-content h2 {
      color: #4FC3F7;
      margin-bottom: 1.5rem;
      border-bottom: 2px solid rgba(79,195,247,0.3);
      padding-bottom: 0.5rem;
      user-select: none;
    }

    /* Browser 页面表格样式（保持不变） */
    .browser-table-container {
      margin-top: 1rem;
      background: rgba(25, 47, 79, 0.5);
      border-radius: 10px;
      padding: 1rem;
      max-height: 60vh;
      overflow: auto;
      border: 1px solid rgba(79,195,247,0.3);
    }
    .browser-table-container h3 {
      color: #4FC3F7;
      margin-bottom: 0.8rem;
      font-size: 1.3rem;
      user-select: none;
    }
    .browser-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1.5rem;
      font-size: 0.9rem;
    }
    .browser-table th {
      background: rgba(79,195,247,0.3);
      padding: 0.6rem;
      text-align: left;
      position: sticky;
      top: 0;
      z-index: 2;
      user-select: none;
    }
    .browser-table td {
      padding: 0.6rem;
      border-bottom: 1px solid rgba(79,195,247,0.2);
      word-break: break-word;
    }
    .browser-table tr:hover {
      background: rgba(79,195,247,0.1);
    }

    .footer {
      position: absolute;
      bottom: 1rem;
      right: 1.5rem;
      color: rgba(255,255,255,0.6);
      font-size: 0.9rem;
      z-index: 2;
      user-select: none;
    }

    /* 响应式调整 */
    @media (max-width: 1200px) {
      .map-container { width: 60%; }
      .home-content { width: 40%; }
      .header-icon { right: 6rem; height: 7rem; width: 7rem; }
      h1 .title-bold { font-size: 2.8rem; }
    }
    @media (max-width: 992px) {
      .content-container { flex-direction: column; }
      .map-container, .home-content { width: 100%; height: 50vh; }
      .home-content {
        border-left: none;
        border-top: 1px solid rgba(79, 195, 247, 0.2);
        grid-template-rows: none; /* 小屏下恢复纵向排列 */
        display: block;
      }
      h1 { position: static; transform: none; text-align: center; margin-bottom: 0.5rem; }
    }

    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: rgba(25,47,79,0.3); border-radius: 4px; }
    ::-webkit-scrollbar-thumb { background: rgba(79,195,247,0.5); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #4FC3F7; }
  </style>
</head>
<body>
  <div class="header">
    <canvas id="oceanCanvas" class="ocean-canvas"></canvas>
    <div class="nav-menu" role="navigation" aria-label="主导航菜单">
      <div class="nav-item active" data-page="home" tabindex="0"><i class="fas fa-home" aria-hidden="true"></i> Home</div>
      <div class="nav-separator" aria-hidden="true">|</div>
      <div class="nav-item" data-page="browser" tabindex="0"><i class="fas fa-database" aria-hidden="true"></i> Browser</div>
      <div class="nav-separator" aria-hidden="true">|</div>
      <div class="nav-item" data-page="download" tabindex="0"><i class="fas fa-download" aria-hidden="true"></i> Download</div>
      <div class="nav-separator" aria-hidden="true">|</div>
      <div class="nav-item" data-page="help" tabindex="0"><i class="fas fa-question-circle" aria-hidden="true"></i> Help</div>
    </div>
    <div class="header-icon" aria-hidden="true">
      <img src="3.png" alt="MHACbase Icon" />
    </div>
    <h1>
      <span class="title-bold">MHACbase</span>
      <span class="title-normal">Microbiome Database for Marine Hypoxic Areas in China</span>
    </h1>
  </div>

  <div id="home" class="content-container" role="main">
    <div class="map-container">
      <div id="world-map" aria-label="世界地图"></div>
      <div id="tooltip" role="tooltip"></div>
      <div id="loader" class="loader" style="display:none;">
        <div class="spinner"></div>
        <div class="loader-text">Loading samples data...</div>
      </div>
      <div id="legend" style="position:absolute; bottom:20px; right:20px; background:rgba(25,47,79,0.85); padding:15px; border-radius:10px; backdrop-filter:blur(5px); border:1px solid rgba(79,195,247,0.3); z-index:10;">
        <div style="font-weight:bold; color:#4FC3F7; margin-bottom:8px; font-size:14px;"><i class="fas fa-map-signs"></i> Legend</div>
        <div style="display:flex; align-items:center; margin-bottom:5px;">
          <div style="width:12px; height:12px; background:#FF0000; border-radius:50%; margin-right:8px;"></div>
          <span style="font-size:13px;">Metagenome</span>
        </div>
        <div style="display:flex; align-items:center;">
          <div style="width:12px; height:12px; background:#FFA500; border-radius:50%; margin-right:8px;"></div>
          <span style="font-size:13px;">Amplicon</span>
        </div>
      </div>
    </div>
    <div class="home-content">
      <div class="stats-card" tabindex="0">
        <h3><i class="fas fa-water"></i> MHACbase</h3>
        <p style="text-align: justify;">
        MHACbase is a compact microbiome database focusing on the hypoxic zone of the Yangtze River Estuary, China, and currently integrates amplicon, metagenomic, metatranscriptomic, and metaproteomic datasets. The amplicon dataset emphasizes microbial diversity and covers China coastal regions, comprising a total of 1,194 samples. The metagenomic component reveals the functional potential of microbial communities, yielding <a href="https://doi.org/10.6084/m9.figshare.25809334" style="color: #4FC3F7; text-decoration: none; font-weight: bold; padding: 2px 4px; border-radius: 3px; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(79,195,247,0.2)'" onmouseout="this.style.background='transparent'"> 4,670,825 non-redundant protein </a> sequences, and enables the reconstruction of <a href="https://doi.org/10.6084/m9.figshare.25809334" style="color: #4FC3F7; text-decoration: none; font-weight: bold; padding: 2px 4px; border-radius: 3px; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(79,195,247,0.2)'" onmouseout="this.style.background='transparent'"> 1,559 species-level genomes </a> of at least medium quality from 103 samples, based on 1.31 Tbp of metagenomic sequencing data. The metatranscriptomic dataset focuses on gene expression of active microorganisms, resulting in the assembly of <a href="https://doi.org/10.6084/m9.figshare.25809334" style="color: #4FC3F7; text-decoration: none; font-weight: bold; padding: 2px 4px; border-radius: 3px; transition: all 0.3s ease;" onmouseover="this.style.background='rgba(79,195,247,0.2)'" onmouseout="this.style.background='transparent'"> 1,605,549 contigs </a>.



 obtained  above medium quality from 1.31 Tbp metagenome data.</p>
        <div class="data-highlight" aria-label="数据高亮">
          <div class="highlight-card" tabindex="0">
            <div id="amplicon-count" class="highlight-value">1194</div>
            <div class="highlight-label">Amplicon</div>
          </div>
          <div class="highlight-card" tabindex="0">
            <div id="metagenome-count" class="highlight-value">103</div>
            <div class="highlight-label">Metagenome</div>
          </div>
          <div class="highlight-card" tabindex="0">
            <div id="metatranscriptomic-count" class="highlight-value">33</div>
            <div class="highlight-label">Metatranscriptomic</div>
          </div>
          <div class="highlight-card" tabindex="0">
            <div id="metaproteome-count" class="highlight-value">15</div>
            <div class="highlight-label">Metaproteome</div>
          </div>
        </div>
      </div>

      <div class="stats-card">
        <h3><i class="fas fa-chart-pie"></i> Microbiome Composition in East China Sea Hypoxia</h3>
        <div id="species-pie-chart"></div>
      </div>
    </div>
  </div>

  <!-- 其他页面保持不变 -->
  <div id="browser" class="page-content" role="region" aria-label="数据浏览">
    <h2><i class="fas fa-database"></i> Data Browser</h2>
    <div id="browser-tables"></div>
  </div>

  <div id="download" class="page-content" role="region" aria-label="下载资源">
    <h2><i class="fas fa-download"></i> Download Resources</h2>
    <p>
      <a href="samples.txt" style="color: white;">Table 1:</a> The description of metagenome data sample.<br />
      <a href="samples1.txt" style="color: white;">Table 2:</a> The description of amplicon data sample.<br />
      <a href="https://figshare.com/articles/dataset/Gene_catalog_of_metagenomic_datasets_generated_in_the_Changjiang_Estuary_and_adjacent_East_China_Sea_/25809334" style="color: white;">Files 1:</a> The sequence of Non-redundant protein.<br />
      <a href="https://figshare.com/articles/dataset/Gene_catalog_of_metagenomic_datasets_generated_in_the_Changjiang_Estuary_and_adjacent_East_China_Sea_/25809334" style="color: white;">Files 2:</a> The sequence of Non-redundant protein abundance.<br />
      <a href="https://figshare.com/articles/dataset/Gene_catalog_of_metagenomic_datasets_generated_in_the_Changjiang_Estuary_and_adjacent_East_China_Sea_/25809334" style="color: white;">Files 3:</a> Metagenome-assembled genomes.<br />
      <a href="https://figshare.com/articles/dataset/Gene_catalog_of_metagenomic_datasets_generated_in_the_Changjiang_Estuary_and_adjacent_East_China_Sea_/25809334" style="color: white;">Files 4:</a> The quality identification of MAGs from checkM.<br />
    </p>
  </div>

  <div id="help" class="page-content" role="region" aria-label="帮助与支持">
    <h2><i class="fas fa-question-circle"></i> Help & Support</h2>
    <p>Contact ail: tangkai@xmu.edu.cn if you have any problems.</p>
    <p>Ciatation:</p>
    <p>Shujing Liu, Quanrui Chen, Congcong Hou, Changjie Dong, Xuanyun Qiu, Kai Tang. Recovery of 1559 metagenome-assembled genomes from the East China Sea's low-oxygen region. Scientific Data. 2024, 11(994) </p>
    <p>Shujing Liu, Quanrui Chen, Congcong Hou, Changjie Dong, Duo Zhao, Quanrui Chen, Jin-Yu Terence Yang, Kai Tang. Integrated multi-omics analyses reveal microbial community resilience to fluctuating low oxygen in the East China Sea. Environmental Research. 2024, 261(2102): 119764 </p>
    <p>Yu Han, Mu Zhang, Xiaofeng Chen, Weidong Zhai, Ehui Tan, Kai Tang. Transcriptomic evidences for microbial carbon and nitrogen cycles in the deoxygenated seawaters of Bohai Sea. Environment International. 2022, 258: 106889 </p>
  </div>

  <div class="footer" aria-label="页脚版权信息">© 2025 MHACbase Database | ONCE | v0.0.1</div>

  <script src="https://unpkg.com/@antv/l7@latest/dist/l7.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // 波浪动画（保持不变）
      const canvas = document.getElementById('oceanCanvas'),
            ctx = canvas.getContext('2d');
      function resizeCanvas() {
        canvas.width = canvas.offsetWidth * window.devicePixelRatio;
        canvas.height = canvas.offsetHeight * window.devicePixelRatio;
        ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
      }
      window.addEventListener('resize', () => {
        ctx.setTransform(1, 0, 0, 1, 0, 0); 
        resizeCanvas();
      });
      resizeCanvas();

      let t = 0;
      function animateWaves() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#0d2b4e';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.beginPath();
        for (let x = 0; x < canvas.width / window.devicePixelRatio; x++) {
          ctx.lineTo(x, Math.sin(x * 0.01 + t) * 12 + canvas.height / window.devicePixelRatio * 0.85);
        }
        ctx.lineTo(canvas.width / window.devicePixelRatio, canvas.height / window.devicePixelRatio);
        ctx.lineTo(0, canvas.height / window.devicePixelRatio);
        ctx.closePath();
        ctx.fillStyle = 'rgba(79,195,247,0.25)';
        ctx.fill();

        ctx.beginPath();
        for (let x = 0; x < canvas.width / window.devicePixelRatio; x++) {
          ctx.lineTo(x, Math.sin(x * 0.015 + t * 1.2) * 8 + canvas.height / window.devicePixelRatio * 0.82);
        }
        ctx.lineTo(canvas.width / window.devicePixelRatio, canvas.height / window.devicePixelRatio);
        ctx.lineTo(0, canvas.height / window.devicePixelRatio);
        ctx.closePath();
        ctx.fillStyle = 'rgba(79,195,247,0.15)';
        ctx.fill();

        t += 0.04;
        requestAnimationFrame(animateWaves);
      }
      animateWaves();

      // 饼图初始化
      function initPieChart() {
        const chartDom = document.getElementById('species-pie-chart');
        const myChart = echarts.init(chartDom);
        const option = {
          backgroundColor: 'transparent',
          tooltip: {
            trigger: 'item',
            formatter: '{b}: {c}%'
          },
          legend: {
            orient: 'horizontal',
            bottom: '0',
            textStyle: { color: '#fff' }
          },
          series: [
            {
              name: 'Microbiome',
              type: 'pie',
              radius: ['40%', '70%'],
              center: ['50%', '50%'],
              avoidLabelOverlap: false,
              itemStyle: {
                borderRadius: 10,
                borderColor: '#1a3a5f',
                borderWidth: 2
              },
              label: {
                show: false,
                position: 'center'
              },
              emphasis: {
                label: {
                  show: true,
                  fontSize: '18',
                  fontWeight: 'bold',
                  color: '#4FC3F7'
                }
              },
              labelLine: {
                show: false
              },
              data: [
  { value: 71.97, name: 'Proteobacteria', itemStyle: { color: '#1F77B4' } }, // 蓝
  { value: 13.59, name: 'Bacteroidota',   itemStyle: { color: '#FF7F0E' } }, // 橙
  { value: 9.72,  name: 'Actinobacteriota', itemStyle: { color: '#2CA02C' } }, // 绿
  { value: 1.39,  name: 'Cyanobacteria', itemStyle: { color: '#17BECF' } }, // 青
  { value: 100-71.97-13.59-9.72-1.39, name: 'Others', itemStyle: { color: '#7F7F7F' } } // 灰
]

            }
          ]
        };
        myChart.setOption(option);
        window.addEventListener('resize', () => myChart.resize());
      }

      // 其余地图、数据加载、页面切换等逻辑保持不变
      function loadData(url, type) {
        document.getElementById('loader').style.display = 'flex';
        return fetch(url).then(r => r.ok ? r.text() : Promise.reject(r.statusText))
          .then(txt => parseSampleData(txt))
          .catch(e => { console.error(e); return [] })
          .finally(() => document.getElementById('loader').style.display = 'none');
      }

      function parseSampleData(txt) {
        const lines = txt.trim().split('\n');
        const header = lines[0].split('\t');
        const arr = [];
        for (let i = 1; i < lines.length; i++) {
          const v = lines[i].split('\t');
          const row = {};
          header.forEach((key, j) => row[key.trim()] = v[j]);
          if (row.latitude && row.longitude) {
            row.latitude = +row.latitude;
            row.longitude = +row.longitude;
          }
          arr.push(row);
        }
        return arr;
      }

      function bindPointLayerEvents(layer, type) {
        const tip = document.getElementById('tooltip');
        layer.on('mousemove', e => {
          if (!e.feature) return;
          const p = e.feature;
          let tooltipHTML = '';
          if (type === 'samples') {
            tooltipHTML = `
              <div style="font-size:1.2rem;color:#FF0000;font-weight:bold;"><i class="fas fa-map-marker-alt"></i> ${p.sample || 'Sample'}</div>
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                <div><strong>Station:</strong> ${p.Station || '—'}</div>
                <div><strong>Source:</strong> ${p.source || '—'}</div>
                <div><strong>Lat:</strong> ${p.latitude}</div>
                <div><strong>Lng:</strong> ${p.longitude}</div>
              </div>`;
          } else if (type === 'samples1') {
            tooltipHTML = `
              <div style="font-size:1.2rem;color:#FFA500;font-weight:bold;"><i class="fas fa-map-marker-alt"></i> ${p.samples || 'Sample'}</div>
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
                <div><strong>Depth:</strong> ${p.depth || '—'}</div>
                <div><strong>Size:</strong> ${p.size || '—'}</div>
                <div><strong>Lat:</strong> ${p.latitude}</div>
                <div><strong>Lng:</strong> ${p.longitude}</div>
                <div><strong>Collection From:</strong> ${p.collection_from || '—'}</div>
              </div>`;
          }
          tip.innerHTML = tooltipHTML;
          tip.style.opacity = 1;
          tip.style.left = e.x + 20 + 'px';
          tip.style.top = e.y - 20 + 'px';
        });
        layer.on('mouseout', () => {
          tip.style.opacity = 0;
        });
      }

      function createPointLayer(data, color, type) {
        return new L7.PointLayer({ zIndex: 2, autoFit: false })
          .source(data, { parser: { type: 'json', x: 'longitude', y: 'latitude' } })
          .shape('circle')
          .size(7)
          .color(color)
          .style({ opacity: 0.85, stroke: '#FFF', strokeWidth: 0 })
          .active(true);
      }

      function initMap() {
        Promise.all([
          loadData('samples.txt', 'samples'),
          loadData('samples1.txt', 'samples1')
        ]).then(([samplesData,samples1Data]) => {
          const scene = new L7.Scene({
            id: 'world-map',
            map: new L7.Map({
              center: [122.5, 25.5],
              zoom: 4.2,
              minZoom: 3.5,
              maxZoom: 10,
              style: 'dark',
              pitch: 0,
              rotateEnable: false
            })
          });
          
          const baseLayer = new L7.RasterLayer({ zIndex: 1 }).source(
            'https://tiles{1-3}.geovisearth.com/base/v1/img/{z}/{x}/{y}?format=webp&token=74ca835f1f23c05319dc4fa7bc4e30540d221d8072ec30bbc5a1d1bfae1dc5b4',
            { parser: { type: 'rasterTile', tileSize: 256 } }
          );

          const sampleLayer = createPointLayer(samplesData, '#FF0000', 'samples');
          const sample1Layer = createPointLayer(samples1Data, '#FFA500', 'samples1');
          
          bindPointLayerEvents(sampleLayer, 'samples');
          bindPointLayerEvents(sample1Layer, 'samples1');

          scene.on('loaded', () => {
            scene.addLayer(baseLayer);
            scene.addLayer(sampleLayer);
            scene.addLayer(sample1Layer);
          });
        });
      }

      function renderBrowserTables() {
        const ctn = document.getElementById('browser-tables');
        ctn.innerHTML = `
          <div class="browser-table-container">
            <h3><i class="fas fa-map-marker-alt"></i> Sample Overview (samples.txt)</h3>
            <table class="browser-table" id="tb-samples">
              <thead><tr><th>Sample</th><th>Latitude</th><th>Longitude</th><th>Salinity</th><th>PH</th><th>Dissolved_oxygen</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="browser-table-container">
            <h3><i class="fas fa-map-marker-alt"></i> New Samples Overview (samples1.txt)</h3>
            <table class="browser-table" id="tb-samples1">
              <thead><tr><th>Station/Sample</th><th>Latitude</th><th>Longitude</th><th>Depth</th><th>Size</th><th>Collection From</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        `;

        loadData('samples.txt', 'samples').then(d => {
          const tbody = document.querySelector('#tb-samples tbody');
          d.forEach(r => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
            <td>${r.Samples || ''}</td>
            <td>${r.latitude}</td>
            <td>${r.longitude}</td>
            <td>${r.Salinity || ''}</td>
            <td>${r.pH || ''}</td>
            <td>${r.Dissolved_oxygen || ''}</td>`;
            tbody.appendChild(tr);
          });
        });

        loadData('samples1.txt', 'samples1').then(d => {
          const tbody = document.querySelector('#tb-samples1 tbody');
          d.forEach(r => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
           <td>${r.samples || ''}</td>
           <td>${r.latitude}</td>
           <td>${r.longitude}</td>
           <td>${r.depth || ''}</td>
           <td>${r.size || ''}</td>
            <td>${r.collection_from || ''}</td>`;
            tbody.appendChild(tr);
          });
        });
      }

      const navs = document.querySelectorAll('.nav-item'),
            home = document.getElementById('home'),
            pages = document.querySelectorAll('.page-content');

      function showPage(id) {
        home.style.display = 'none';
        pages.forEach(p => p.style.display = 'none');
        navs.forEach(n => n.classList.remove('active'));
        document.querySelector(`.nav-item[data-page="${id}"]`).classList.add('active');
        if (id === 'home') {
           home.style.display = 'flex';
        } else {
          document.getElementById(id).style.display = 'block';
          if (id === 'browser') renderBrowserTables();
        }
      }

      navs.forEach(n => n.addEventListener('click', () => showPage(n.dataset.page)));
      
      showPage('home');
      initMap();
      initPieChart();
    });
  </script>
</body>
</html>